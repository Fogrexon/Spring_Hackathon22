const S=function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const g of document.querySelectorAll('link[rel="modulepreload"]'))o(g);new MutationObserver(g=>{for(const A of g)if(A.type==="childList")for(const h of A.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&o(h)}).observe(document,{childList:!0,subtree:!0});function t(g){const A={};return g.integrity&&(A.integrity=g.integrity),g.referrerpolicy&&(A.referrerPolicy=g.referrerpolicy),g.crossorigin==="use-credentials"?A.credentials="include":g.crossorigin==="anonymous"?A.credentials="omit":A.credentials="same-origin",A}function o(g){if(g.ep)return;g.ep=!0;const A=t(g);fetch(g.href,A)}};S();var E="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAYAAADDPmHLAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAOoSURBVHgB7Z3LceMwEAXlLeWh2+awQW00G9Tm4GTs4mGqWDRACsRvMK/74IttmdRrDmhiAH28Xq+vB8jy3L78/vM3+wOf//89rn6mNx6OYRSjz/XXA6RBAHEQQBwEEAcBxEEAcRBAHAQQBwHEQQBxEEAcBBAHAcT5YDpYGyqAOJf9AL1YfY7f8/Hbse3JHScVIBBb8Pvw96GnpNh4PmB5juGWVCUqwMIcr/iNY/hXVYAKsCAlY7x9jyEgAKXB515j/zsIsAAtgs9VAQRwTIvgc69rr4MADukVfKoKIIAjegWf+1vbayOAA0YGf6wCCDCRkcHn/j4CTGB28PsqgAADmR186jjoB5jE7OANKsBgvARvTOsHuEOPOfizN6cl3oI3qACd8Rq8gQCd8B68gQCNWSV4AwEasVrwBgJUsmrwBgLcZPXgDQQoJErwBgK8SbTgDQS4IGrwBgJkiB68gQAHVII3LgUYcXBe5iJGH8fM4A1WBu0YFUhqRc8sLvsBel8VXt4Io+f5ejvXDSrAgR4hebrij2T7AVacJ6/tF2h9zj0XdrR6Lf4LSHBcP3fn9494bbpBgB1nq2jfYaXgDQTIUFIFVgze+CGA15uVUZRUgZWDN7IVYLUT6UGuCkQI3mAISJCrApGCNxDgDSIGb/AgKIMFnNqEKdLwGKICKE1YtSbUENA6JIUb4awAPa4q/rPwB/cA4gwdAtQfMnmE/QHEYQgQ59n6xqzHGv6ZRDufI1QAcRBAHAQQJ9xkUO4jUyBNqArAc4ZyQgiQa7tGiGuWHgLO5ukJ/z2WFKCkQaO2xTs6SwlQEnxti7cKSwhQ25JFFcjjWoDa4KkC17gUoEcTJlUgjSsBegRPFTjHbT/AijuCr4g7AXp+Shb8pEk/QIs3d9b47G29fivePabpj4JHLbTgBjDNtJtAxR25PDJcAIL3xTABCN4n3QUgeN90E4Dg16BKAA/r5gm+jlsCEHwcigVIbZgwEoJvy+0hgOBjcPtJoOLO2hEpFmDUlU/wY6iaC1DbWTsi1dPBrSoCoc+hST9A6521YRzPWeGV9vaffX8kI45l5Pk2eRSssrN2RKoEUNtZOyLNJoMUdtaOSLUASjtrR6TpdHBuOCB4vzRpCj1boEn4vmlWAQh6TdgkShwEEAcBxEEAcRBAHAQQh88LEIcKIM6zdBpXZU6+N17OgQogDgKIgwDiIIA4CCAOAoiDAOIggDgIIA4CiIMA4iCAOAggDv0A4nwDGWbBhUzQF78AAAAASUVORK5CYII=",p="/Spring_Hackathon22/assets/gameover.71c6430d.png",M="/Spring_Hackathon22/assets/ghost.3a9094a8.png",R="data:image/png;base64,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",b="/Spring_Hackathon22/assets/player.22b49827.png",Q="/Spring_Hackathon22/assets/result.06168fae.png",H="/Spring_Hackathon22/assets/title.8b461e55.png",U="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAABACAYAAADS1n9/AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAESSURBVHgB7dyxSUNRGIbhP5IFBCtLiyxha5EtHMB5HMAtUti6RApLK8ERFC4ngq7wvE9zkjLw8hEuh7ubme8J62pC218+vJ/PI7k7HP58V39/C4ArAFwB4AoAVwC4AsAVAK4AcAWAKwBcAeAKAFcAuALAFQCuAHD7yeb/BRFFC4ArAFwB4PoPsDw+3Yzk5flzO1sAXAHgCgBXALgCwBUArgBwBYArAFwB4AoAVwC4AsAVAK4AcAWA2816T6D+ljBVC4DrStjyejqN5OF43M4WAFcAuALAFQCuAHAFgCsAXAHgehC0XB6MaFoAXAuwXN/ej+Tr4207WwBcAeAKAFcAuALAFQCuAHAFgPu9FRxTC4D7AdmVFsm2ZkGzAAAAAElFTkSuQmCC",x="/Spring_Hackathon22/assets/item.3a8ace43.png";const l=e=>{const r=new Image;return r.src=e,r},L={floor:l(E),gameover:l(p),ghost:l(M),heartAnimation:l(R),player:l(b),result:l(Q),title:l(H),wall:l(U),item:l(x)},u=e=>L[e],F=(e,r)=>Math.abs(Math.sin(e*12.9898+r*78.233)%1),N=(e,r)=>{const{data:t,width:o,height:g}=e,{width:A,height:h}=r.canvas,s=A/o,i=h/g;for(let n=0;n<g;n+=1)for(let c=0;c<o;c+=1){const f=t[n*o+c],I=n===g-1?".":t[(n+1)*o+c],C=Math.floor(F(c,n)*4);f==="."?r.drawImage(u("floor"),C%2*64,Math.floor(C/2)*64,64,64,c*s,n*i,s,i):I==="#"?r.drawImage(u("wall"),0,0,64,64,c*s,n*i,s,i):r.drawImage(u("wall"),64,0,64,64,c*s,n*i,s,i)}for(let n=0;n<e.items.length;n+=1){const[c,f]=e.items[n];e.exist[n]&&r.drawImage(u("item"),64*(n%3)+64,0,64,64,c*s,f*i,s,i)}const[m,a]=e.post;r.drawImage(u("item"),0,0,64,64,m*s,a*i,s,i)},O={ArrowUp:[64,0,64,64],ArrowDown:[128,0,64,64],ArrowLeft:[0,0,64,64],ArrowRight:[192,0,64,64],None:[0,0,0,0]},G={student:64,monk:128,exorcist:0},j=(e,r,t)=>{const{x:o,y:g}=e,{width:A,height:h}=t.canvas,s=A/r.width,i=h/r.height,m=u("player"),[a,n,c,f]=O[e.forward];t.drawImage(m,a,G[e.shurui]+n,c,f,o*s,g*i,s,i)},T={gUp:[64,0,64,64],gDown:[128,0,64,64],gLeft:[0,0,64,64],gRight:[192,0,64,64],None:[0,0,0,0]},P={random:64,chase:128},X=(e,r,t)=>{const{gx:o,gy:g}=e,{width:A,height:h}=t.canvas,s=A/r.width,i=h/r.height,m=u("ghost"),[a,n,c,f]=T[e.gdirect];t.drawImage(m,a,P[e.gtype]+n,c,f,o*s,g*i,s,i);const I=performance.now()/1e3*4,C=Math.floor(I)%3;t.drawImage(u("heartAnimation"),C*64,0,64,64,o*s,g*i,s,i)},w={mode:"title",start:0,end:0},K={data:`
####################
#..................#
#.#######..#######.#
#.#..............#.#
#.#.#########.##.#.#
#.#.#..........#.#.#
#...#.##.#####.#...#
#.#.#.#......#.#.#.#
#.#...#.##.#...#.#.#
#.#.#.#.#..#.#.#.#.#
#.#.#.#.#..#.#.#.#.#
#.#.#...#.##.#...#.#
#.#.#.#......#.#.#.#
#...#.#####.##.#...#
#.#.#..........#.#.#
#.#.##.#########.#.#
#.#..............#.#
#.#######..#######.#
#..................#
#################### 
`.replace(/\n/g,""),width:20,height:20,items:[[3,3],[16,16],[18,1],[1,18]],exist:[!0,!0,!0,!0],post:[9,9]},W={data:`
####################
#..................#
#.#.##.#.#.##.#.##.#
#.#.#..#.#..#.#..#.#
#........##.#.##...#
#.###.##.#.......#.#
#.#...##...##.##.#.#
#.#.#....#.#.......#
#.#.#.#.##.#.###.#.#
#.#...#..#...#...#.#
#...#..#...#...###.#
#.####...#####.#...#
#...#..#.......#.#.#
#.#...##.#.###.#.#.#
#.#.#....#.#.......#
#...#.#.##.#.#####.#
#.###.#..........#.#
#.#...###.#.####.#.#
#..................#
####################
`.replace(/\n/g,""),width:20,height:20,items:[[1,1],[16,3],[3,17],[18,18]],exist:[!0,!0,!0,!0],post:[10,9]},V={data:`
####################
#.#........##.#....#
#.#.###.##....#.####
#.#.#...##.##......#
#.#.#.#.##.##.####.#
#...#...#........#.#
###.###...#.##.#...#
#.....#####.##.#####
#.###.....#.#......#
#.....###...###.##.#
#####..#...####.##.#
#......#.#......##.#
#.####.#.#####.....#
#...##.#.#...#.#.###
#.#......#.#.#.#...#
#.####.#.......#.#.#
#......#######.#.#.#
####.#.#....##.#.#.#
#....#...##......#.#
####################
`.replace(/\n/g,""),width:20,height:20,items:[[1,1],[18,1],[1,18],[18,18]],exist:[!0,!0,!0,!0],post:[10,9]},B={current:0,maps:[K,W,V]},J=()=>{B.current<B.maps.length-1?B.current+=1:(w.mode="result",w.end=performance.now())},z=()=>B.maps[B.current],q=()=>{B.current=0;for(let e=0;e<B.maps.length;e+=1)B.maps[e].exist=[!0,!0,!0,!0]},k=(e,r)=>{for(let t=0;t<r.items.length;t+=1)if(e.preX===r.items[t][0]&&e.preY===r.items[t][1]&&e.have===0&&r.exist[t])return r.exist[t]=!1,t;return-1},Z=(e,r)=>e.preX===r.post[0]&&e.preY===r.post[1],y=(e,r)=>e.x<r.gx+1&&r.gx<e.x+1&&e.y<r.gy+1&&r.gy<e.y+1,_=(e,r,t)=>{const o=(h,s)=>{const{width:i}=r;return r.data[s*i+h]!=="#"},g=performance.now()/1e3;let A=.1;switch(e.shurui){case"student":A=.5;break;case"monk":A=.7;break;case"exorcist":A=.6;break}if(e.targetX===e.preX&&e.targetY===e.preY&&(A=0),g-e.start<A)e.x=(e.targetX-e.preX)*((g-e.start)/A)+e.preX,e.y=(e.targetY-e.preY)*((g-e.start)/A)+e.preY;else{switch(e.start=g,e.preX=e.targetX,e.x=e.preX,e.preY=e.targetY,e.y=e.preY,e.forward=e.direction==="None"?e.forward:e.direction,e.direction){case"ArrowUp":e.targetX=e.preX,e.targetY=e.preY-1;break;case"ArrowDown":e.targetX=e.preX,e.targetY=e.preY+1;break;case"ArrowLeft":e.targetX=e.preX-1,e.targetY=e.preY;break;case"ArrowRight":e.targetX=e.preX+1,e.targetY=e.preY;break}o(e.targetX,e.targetY)||(e.targetX=e.preX,e.targetY=e.preY),k(e,r)!==-1&&e.have===0&&(e.have=1),Z(e,r)&&(e.nouhin+=e.have,e.have=0),e.nouhin===r.items.length&&(e.nouhin=0,J())}for(let h=0;h<t.length;h+=1)y(e,t[h])&&(w.mode="result2")},$=e=>{window.addEventListener("keydown",r=>{if(w.mode==="game")switch(r.key){case"ArrowUp":e.direction="ArrowUp";break;case"ArrowDown":e.direction="ArrowDown";break;case"ArrowLeft":e.direction="ArrowLeft";break;case"ArrowRight":e.direction="ArrowRight";break}}),window.addEventListener("keyup",()=>{e.direction="None"})},D=(e,r)=>{e.x=10,e.y=10,e.targetX=10,e.targetY=10,e.preX=10,e.preY=10,e.have=0,e.nouhin=0;for(let t=0;t<r.length;t+=1)r[t].gx=5,r[t].gy=5,r[t].gtargetX=5,r[t].gtargetY=5,r[t].gpreX=5,r[t].gpreY=5;q(),w.start=performance.now()},ee=e=>{const r=u("title"),{width:t,height:o}=e.canvas,g=r.width/r.height,A=(o*g-t)/2;e.drawImage(r,-A,0,o*g,o)},re=e=>{const r=w.end-w.start,t=Math.round(r/1e3),o=u("result"),{width:g,height:A}=e.canvas,h=o.width/o.height,s=(A*h-g)/2;e.drawImage(o,-s,0,A*h,A),e.fillStyle="#ffffff",e.font='75px "Press Start 2P", sans-serif';const i=`0${Math.floor(t/60)}`.slice(-2),m=`0${t%60}`.slice(-2);e.fillText(String(i),125,290),e.fillText(String(m),325,290)},te=e=>{const r=u("gameover"),{width:t,height:o}=e.canvas,g=r.width/r.height,A=(o*g-t)/2;e.drawImage(r,-A,0,o*g,o)},ne=e=>{window.addEventListener("keydown",r=>{if(w.mode==="title")switch(r.key){case"1":e.shurui="monk",w.mode="game";break;case"2":e.shurui="exorcist",w.mode="game";break;case"3":e.shurui="student",w.mode="game";break}})},ge=()=>{window.addEventListener("keydown",e=>{w.mode==="result"&&(e.key===" "&&(w.mode="title"),e.key==="e"&&window.open(`https://twitter.com/intent/tweet?text=ConSoul\u3092${3}\u5206${3}\u79D2\u3067\u30AF\u30EA\u30A2\u3057\u307E\u3057\u305F\uFF01&hashtags=ConSoul`,"_blank"))})},oe=()=>{window.addEventListener("keydown",e=>{w.mode==="result2"&&e.key===" "&&(w.mode="title")})},d={left:Math.floor(Math.random()*-1e3),right:Math.floor(Math.random()*-1e3),up:Math.floor(Math.random()*-1e3),down:Math.floor(Math.random()*-1e3)},Ae={student:20*20,exorcist:6*6,monk:4*4},se=(e,r,t)=>{const o=(n,c,f)=>{Y(c.gtargetX,c.gtargetY-1,f)||(n.up=1e4),Y(c.gtargetX,c.gtargetY+1,f)||(n.down=1e4),Y(c.gtargetX-1,c.gtargetY,f)||(n.left=1e4),Y(c.gtargetX+1,c.gtargetY,f)||(n.right=1e4)},g=(n,c)=>{c.gdirect==="gUp"?n.down=9999:c.gdirect==="gDown"?n.up=9999:c.gdirect==="gLeft"?n.right=9999:c.gdirect==="gRight"&&(n.left=9999)},A=()=>{d.left=Math.floor(Math.random()*-1e3),d.right=Math.floor(Math.random()*-1e3),d.up=Math.floor(Math.random()*-1e3),d.down=Math.floor(Math.random()*-1e3)},h=(n,c)=>{Math.min(n.up,n.down,n.left,n.right)===n.up?c.gdirect="gUp":Math.min(n.up,n.down,n.left,n.right)===n.down?c.gdirect="gDown":Math.min(n.up,n.down,n.left,n.right)===n.left?c.gdirect="gLeft":Math.min(n.up,n.down,n.left,n.right)===n.right&&(c.gdirect="gRight")},s=e.gx-r.x,i=e.gy-r.y,m=s*s+i*i;let a=e.gtype;switch(m>Ae[r.shurui]&&(a="random"),a){case"random":{A(),o(d,e,t),g(d,e),h(d,e);break}case"chase":{d.up=s**2+(i-1)**2,d.down=s**2+(i+1)**2,d.left=(s-1)**2+i**2,d.right=(s+1)**2+i**2,o(d,e,t),g(d,e),h(d,e);break}default:throw new Error("Unknown GhostType")}},Y=(e,r,t)=>{const{width:o}=t;return t.data[r*o+e]!=="#"},v=(e,r,t)=>{const o=Date.now()/1e3;if(o-e.gstart<e.ginterval)e.gx=(e.gtargetX-e.gpreX)*((o-e.gstart)/e.ginterval)+e.gpreX,e.gy=(e.gtargetY-e.gpreY)*((o-e.gstart)/e.ginterval)+e.gpreY;else{switch(se(e,t,r),e.gstart=o,e.gpreX=e.gtargetX,e.gpreY=e.gtargetY,e.gdirect){case"gUp":e.gtargetX=e.gpreX,e.gtargetY=e.gpreY-1;break;case"gDown":e.gtargetX=e.gpreX,e.gtargetY=e.gpreY+1;break;case"gLeft":e.gtargetX=e.gpreX-1,e.gtargetY=e.gpreY;break;case"gRight":e.gtargetX=e.gpreX+1,e.gtargetY=e.gpreY;break;default:throw new Error("ghostDirectionError\u3067\u3059")}Y(e.gtargetX,e.gtargetY,r)||(e.gtargetX=e.gpreX,e.gtargetY=e.gpreY)}},ce=e=>{e.save();const{width:r,height:t}=e.canvas;e.translate((r-t)/2,0),e.scale(t/r,1)},ie=e=>{e.restore()},he=(e,r)=>{ce(e),r(),ie(e)},we=()=>{const e=document.getElementById("cnv");if(!e)throw new Error("Canvas not found");const r=e.getContext("2d");if(!r)throw new Error("Canvas context not found");r.imageSmoothingEnabled=!1;const t={x:10,y:10,direction:"None",forward:"ArrowRight",targetX:10,targetY:10,preX:1,preY:1,start:0,have:0,nouhin:0,shurui:"student"},o={gtype:"random",gx:5,gy:5,gdirect:"gNone",ginterval:.5,gtargetX:5,gtargetY:5,gpreX:5,gpreY:5,gstart:Date.now()/1e3},g={gtype:"chase",gx:5,gy:5,gdirect:"gNone",ginterval:.5,gtargetX:5,gtargetY:5,gpreX:5,gpreY:5,gstart:Date.now()/1e3};let A="title";$(t),ne(t),ge(),oe();const h=()=>{requestAnimationFrame(h),r.clearRect(0,0,e.width,e.height);const s=z();switch(w.mode){case"title":{ee(r);break}case"game":A==="title"&&D(t,[o,g]),v(o,s,t),v(g,s,t),_(t,s,[o,g]),he(r,()=>{N(s,r),j(t,s,r),X(o,s,r),X(g,s,r)});break;case"result":re(r);break;case"result2":te(r);break;default:throw new Error("Unknown mode")}A=w.mode};h()};we();
